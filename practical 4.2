const express = require('express');
const app = express();
const PORT = 3000;

// Middleware to parse JSON
app.use(express.json());

// In-memory storage for playing cards
let cards = [
    {
        id: 1,
        suit: "Hearts",
        value: "Ace"
    },
    {
        id: 2,
        suit: "Spades",
        value: "King"
    },
    {
        id: 3,
        suit: "Diamonds",
        value: "Queen"
    }
];

let nextId = 4;

// GET /cards - Retrieve all cards
app.get('/cards', (req, res) => {
    res.status(200).json(cards);
});

// GET /cards/:id - Retrieve a specific card by ID
app.get('/cards/:id', (req, res) => {
    const cardId = parseInt(req.params.id);
    const card = cards.find(c => c.id === cardId);
    
    if (!card) {
        return res.status(404).json({ message: `Card with ID ${cardId} not found` });
    }
    
    res.status(200).json(card);
});

// POST /cards - Add a new card
app.post('/cards', (req, res) => {
    const { suit, value } = req.body;
    
    // Validation
    if (!suit || !value) {
        return res.status(400).json({ message: 'Both suit and value are required' });
    }
    
    const newCard = {
        id: nextId++,
        suit: suit,
        value: value
    };
    
    cards.push(newCard);
    res.status(201).json(newCard);
});

// DELETE /cards/:id - Remove a specific card by ID
app.delete('/cards/:id', (req, res) => {
    const cardId = parseInt(req.params.id);
    const cardIndex = cards.findIndex(c => c.id === cardId);
    
    if (cardIndex === -1) {
        return res.status(404).json({ message: `Card with ID ${cardId} not found` });
    }
    
    const deletedCard = cards.splice(cardIndex, 1)[0];
    res.status(200).json({
        message: `Card with ID ${cardId} removed`,
        card: deletedCard
    });
});

// Start the server
app.listen(PORT, () => {
    console.log(`Playing Card Collection API server running on port ${PORT}`);
    console.log(`Access at: http://localhost:${PORT}`);
    console.log('\nAvailable endpoints:');
    console.log('GET    /cards      - Get all cards');
    console.log('GET    /cards/:id  - Get card by ID');
    console.log('POST   /cards      - Add new card');
    console.log('DELETE /cards/:id  - Delete card by ID');
});

module.exports = app;
